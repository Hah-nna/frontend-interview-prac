# 프로세스와 스레드를 비교하여 설명해주실 수 있을까요?

## 프로그램

어떤 작업을 위해 실행할 수 있는 파일

## 프로세스

프로그램을 실행해주는 주체
ex: 슬랙을 실행하는 프로세스

메모리에 올라와 실행되고 있는 프로그램의 인스턴스임
자세히 말하자면 하드디스크에 있는 프로그램을 실행하면 실행을 위해 메모리 할당이 일어나고, 할당된 메로리 공간으로 바이너리 코드가 올라감. 이 순간부터 프로세스라고 부름

프로세스는 각각의 독립된 메모리 영역(code, data, stack, heap)을 할당 받음

- 코드 영역 : 프로그래머가 작성한 프로그램이 저장되는 영역.
  (실행할 프로그램의 코드나 명령어들)
  CPU는 코드 영역에 저장된 명령어들을 하나씩 처리함.
- 데이터 영역 : 코드에서 선언한 변수나 파일들의 각종 데이터들이 저장되는 영역.
  프로그램이 실행되면서 할당되고 종료되면서 소멸함
- 스택 영역 : 함수 안에서 선언된 지역변수, 매개 변수, 리턴 값 등이 저장됨. 함수 호출 시 기록되고 종료되면 제거됨
- 힙 영역 : 동적으로 할당되는 데이터를 위해 존재함

프로세스는 최소 1개 이상의 스레드를 가지고 있으며, 각 프로세스는 별도의 주소 공간에서 실행되며 기본적으로 다른 프로세스의 자원에 접근할 수 없음.
어떤 한 프로세스가 다른 프로세스에 접근하려면 프로세스 간 통신(IPC(inter process communication))를 해야함
ex: 소켓이나 파일, 파이프 등을 이용한 통신 방법

프로세스 내에는 최소 한 개의 스레드를 가지고 스레드 단위로 스케줄링을 함

=> 우리가 음악을 들으면서 메일을 보내고 카톡 메시지가 오는 등의 여러 프로세스가 동시에 실행되는 것처럼 보이지만 CPU는 한 번에 하나의 명령밖에 처리할 수 없음. 즉 동시에 처리되는 것처럼 보여도 사실은 프로세스들을 빠르게 번갈아가면서 실행하고 관리하는 것임

## 스레드

<img src="https://velog.velcdn.com/cloudflare/aeong98/411e94f9-758b-40e3-93cb-938cde5fbd15/image.png" width="50%" height="50%">

프로세스에 올라온 작업을 처리해주는 주체
ex: 메세지 발송을 처리하는 스레드

프로세스가 할당받은 자원을 이용하는 최소 단위임

스레드는 프로세스 내에서 필요한 스택만 할당받고 코드, 힙, 데이터 영역은 각 스레드가 공유함(같은 프로세스 내에 있는 스레드끼리 자원(코드, 데이터, 힙)을 공유하며 실행됨)

## CPU

컴퓨터가 사용자의 명령에 대한 작업을 수행하는 처리장치

cpu는 한정된 자원을 가지고 있어 최대한의 성능을 이끌어내기 위해서는 cpu를 적절하고 효율적으로 사용해야함
즉, OS는 실행대기 중인 프로그램(프로세스)들에게 CPU 자원 배정을 적절히해 시스템의 성능을 끌어올릴 수 있음

## 프로세스와 스레드의 차이점

<img src="https://velog.velcdn.com/cloudflare/aeong98/2ab2b490-e027-4b03-9a54-8104199b6c60/image.png" width="50%" height="50%">

운영체제는 프로세스마다 독립된 메모리 영역을 code,data,stack,heap의 형식으로 할당함.
각각 독립된 메모리 영역을 할당하기 때문에 프로세스는 다른 프로세스의 변수나 자료에 접근할 수 없음

<img src="https://velog.velcdn.com/cloudflare/aeong98/ce1b2913-bef7-46ff-9444-00dbd22489ef/image.png" width="50%" height="50%">

이와 달리 스레드는 메모리를 서로 공유할 수 있음. 즉, 프로세스가 할당받은 메모리 영역 내에서 stack 형식으로 할당된 메모리 영역은 따로 할당받고 나머지 영역(code, heap, data) 을 공유함. 따라서 각각의 스레드는 별도의 스택을 가지고 있지만 code, heap, data 부분은 서로 공유해 읽고 쓸 수 있게 됨

### 왜 이렇게 메모리를 공유하나요?

1. 자원 공유: 스레드간에 코드, 데이터, 힙 영역을 공유하기 때문에, 자원을 효율적으로 사용할 수 있음. 각 스레드가 서로 다른 작업을 수행하더라도 기본적인 코드와 데이터를 공유함으로써 메모리 공간을 절약할 수 있음

2. 병렬성능 향상: 특정 작업을 서로 다른 스레드에서 동시에 진행할 수 있어서 동시성과 병렬성을 향상시킬 수 있음. 이렇게 동시에 실행되는 스레드를 통해 프로그램 전체의 성능이 향상될 수 있음.

3. 응답성 향상: 특정 스레드에서 작업이 오래 걸리더라도 다른 스레드는 계속 진행될 수 있어서 전체적인 응답성을 향상시킬 수 있음. 예를 들어 UI 스레드와 작업 스레드를 분리하여 프로그램의 사용자 인터페이스가 더욱 반응이 빨라질 수 있음.
   그러나 메모리를 공유하게 되면 동시성 제어\* 가 필요하게 됨. 예를 들어 동시에 읽고 쓰는 등의 작업이 발생할 때 데이터의 정합성이 깨질 수 있기 때문에 스레드 간 동기화나 뮤텍스(mutex) 등의 기술을 사용하여 동시성 문제를 해결할 수 있음

\*동시성 제어
여러 개의 스레드가 동시에 공유된 자원에 접근하거나 어떤 한 스레드가 데이터를 수정하는 동안 다른 스레드가 동일한 데이터에 접근하거나 변경을 하면 예상치 못한 결과나 오류가 발생할 수 있음. 이를 예방 및 방지하는 기법
